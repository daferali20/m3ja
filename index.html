<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rental Options</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.5.2/dist/web3.min.js"></script>
    <script type="module" src="app.js"></script> <!-- تأكد من ربط ملف JavaScript هنا -->
</head>
<body>
     <div class="container">
        <h1>Rental Options</h1>

        <!-- خيارات الإيجار -->
        <div class="rental-item">
            <h2 id="planName">Unlocked</h2>
            <p>Rental price: <span id="planPrice">500.01 USDT</span></p>
            <p>Rental days: <span id="rentalDays">30 D</span></p>
            <p>Yield rate: <span><img src="yield-icon.png" alt="Yield Rate" class="yield-icon"> 2.50%</span></p>
            <p>Yield: <span>37.5 USDT</span></p>
            <button class="buy-button" onclick="buyPlan()">BUY</button>
        </div>
        <div id="walletAddress"></div>
       <button id="connectWallet">Connect Wallet</button>
        <div class="rental-item">
            <h2>Unlocked</h2>
            <p>Rental price: <span>1000.00 USDT</span></p>
            <p>Rental days: <span>30 D</span></p>
            <p>Yield rate: <span><img src="yield-icon.png" alt="Yield Rate" class="yield-icon"> 2.80%</span></p>
            <p>Yield: <span>84 USDT</span></p>
            <button class="buy-button" onclick="buyPlan()">BUY</button>
        </div>

        <div class="rental-item">
            <h2>Unlocked</h2>
            <p>Rental price: <span>3000.00 USDT</span></p>
            <p>Rental days: <span>30 D</span></p>
            <p>Yield rate: <span><img src="yield-icon.png" alt="Yield Rate" class="yield-icon"> 3.00%</span></p>
            <p>Yield: <span>270 USDT</span></p>
            <button class="buy-button" onclick="buyPlan()">BUY</button>
        </div>

        <div class="rental-item">
            <h2>Unlocked</h2>
            <p>Rental price: <span>5000.00 USDT</span></p>
            <p>Rental days: <span>40 D</span></p>
            <p>Yield rate: <span><img src="yield-icon.png" alt="Yield Rate" class="yield-icon"> 3.50%</span></p>
            <p>Yield: <span>700 USDT</span></p>
            <button class="buy-button" onclick="buyPlan()">BUY</button>
        </div>

        <div class="rental-item">
            <h2>Unlocked</h2>
            <p>Rental price: <span>10000.00 USDT</span></p>
            <p>Rental days: <span>40 D</span></p>
            <p>Yield rate: <span><img src="yield-icon.png" alt="Yield Rate" class="yield-icon"> 4.00%</span></p>
            <p>Yield: <span>1600 USDT</span></p>
            <button class="buy-button" onclick="buyPlan()">BUY</button>
        </div>

        <!-- يمكنك إضافة المزيد من خيارات الإيجار بنفس النمط -->
    </div>

    <!-- الفوتر -->
    <footer>
        <nav class="footer-nav">
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="ppbwa.html">My Account</a></li>
                <li><a href="miner.html">Miner</a></li>
                <li><a href="ordd.html">Orders</a></li>
            </ul>
        </nav>
    </footer>

   <script>
        async function connectWallet() {
            if (window.ethereum) {
                const web3 = new Web3(window.ethereum);
                try {
                    await window.ethereum.request({ method: 'eth_requestAccounts' });
                    const accounts = await web3.eth.getAccounts();
                    document.getElementById("walletAddress").innerText = `Wallet Address: ${accounts[0]}`;
                } catch (error) {
                    console.error("User denied account access", error);
                }
            } else {
                alert("Please install MetaMask to connect your wallet.");
            }
        }

        const connectButton = document.getElementById("connectWallet");
        if (connectButton) {
            connectButton.addEventListener("click", connectWallet);
        }

        async function buyPlan() {
            if (!window.ethereum) {
                alert("Please install MetaMask to use this feature.");
                return;
            }

            const web3 = new Web3(window.ethereum);
            const accounts = await web3.eth.getAccounts();
            if (accounts.length === 0) {
                alert("Please connect your wallet first.");
                return;
            }

            const planPrice = parseFloat(document.getElementById("planPrice").innerText);
            const planName = document.getElementById("planName").innerText;

            // هنا يجب عليك إضافة الكود الخاص بإجراء الدفع باستخدام smart contract
             // إذا كانت المعاملة ناجحة:
            sessionStorage.setItem("planName", planName);
            sessionStorage.setItem("planPrice", planPrice);
            sessionStorage.setItem("startDate", new Date().toLocaleDateString("ar-EG"));
            sessionStorage.setItem("durationDays", 30);
        
            // الانتقال إلى صفحة تفاصيل الطلب
            window.location.href = "ordd.html";
        }
    </script>
</body>
</html>
